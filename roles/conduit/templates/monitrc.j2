# AUTOMATICALLY GENERATED BY ANSIBLE, EDITS WILL BE LOST

# Log to syslog
set logfile syslog facility log_daemon

# Poll every 5 seconds
set daemon 5

# Use a Unix socket for monitoring
set httpd unixsocket /var/run/monit.sock
    allow monit:monit

# Monitor the system
check system ${HOST}

# XXX - monitor network

# XXX - Monitor /var/config and /etc for changes?

# Monitor ttn-pkt-forwarder
check process ttn-pkt-forwader PIDFILE /var/run/lora-pkt-fwd.pid
   start program = "/etc/init.d/ttn-pkt-forwarder start" with timeout 15 seconds
   stop program = "/etc/init.d/ttn-pkt-forwarder stop"

{% if ssh_tunnel_enabled %}
# Monitor autossh
check process ssh_tunnel PIDFILE /var/run/ssh_tunnel.pid
    start program = "/etc/init.d/ssh_tunnel start" with timeout 15 seconds
    stop program = "/etc/init.d/ssh_tunnel stop"
{% endif %}

# Monitor sshd
check process sshd PIDFILE /var/run/sshd.pid
    start program = "/etc/init.d/sshd start" with timeout 15 seconds
    stop program = "/etc/init.d/sshd stop"

# Monitor ntpd
check process ntpd PIDFILE /var/run/ntp.pid
    start program = "/etc/init.d/ntpd start" with timeout 15 seconds
    stop program = "/etc/init.d/ntpd stop"
