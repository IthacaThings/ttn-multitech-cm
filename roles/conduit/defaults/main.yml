---

# Conduit type
conduit_type: "{{ ansible_local.conduit.hw_version | regex_replace('-[0-9.]+$') | lower }}"

# Authorized keys
authorized_keys: []

# Where to fetch the kersing packages
forwarder_baseurl_kersing: https://github.com/kersing/multitech-installer/raw/master
# Command to run when rotating logs
forwarder_logrotate_command: /etc/init.d/ttn-pkt-forwarder restart

# Multi-tech version of mLinux images
#mlinux_upgrade_bin: "mlinux-{{ 'factory' if conduit_type == 'mtcdt' else conduit_type }}-image-{{ conduit_type }}-upgrade.bin"
#mlinux_url: "http://www.multitech.net/mlinux/images/{{ conduit_type }}/{{ mlinux_version }}"
# TTNI version of mLinux images
mlinux_upgrade_bin: "ttni-base-image-{{ conduit_type }}-upgrade.bin"
mlinux_url: "https://github.com/IthacaThings/mlinux-images/raw/master/{{mlinux_version }}/{{ conduit_type }}"

# For configuration of TTN Console
gateway_brand: MultiTech
gateway_model: "{{ ansible_local.conduit.product_id }}"
antenna_type: "{{ 'internal' if conduit_type == 'mtcap' else '3.0dBi Rubber Duck' }}"
antenna_model: "{{ 'internal' if conduit_type == 'mtcap' else 'MultiTech AN868-915A-1HRA' }}"

# SSH tunnel
ssh_tunnel_ssh_key: /etc/ssh/ssh_host_rsa_key
ssh_tunnel_daemon: /usr/bin/autossh
ssh_tunnel_ssh_port: 22
ssh_tunnel_base_port: 0

# Static Nameserver defaults
resolv_conf_static: /var/config/network/resolv.conf-static
static_nameservers:
  - 8.8.8.8
  - 8.8.4.4

# In some cases the use of ssh tunnels and PathMTU cause issues, so
# reduce the MTU of interfaces to avoid this issue.
# See http://changelog.complete.org/archives/9335-ssh-suddenly-stops-communicating-with-some-hosts
eth0_mtu: 1100
wlan0_mtu: 1100

# By default the DHCP client sends three packets over three seconds
# and then gives up.  Change this so it will keep going forever (90
# days).
eth0_udhcpc_opts: -b -t 2592000
wlan0_udhcp_opts: -b -t 2592000

# WPA stuff
wpa_conf: /var/config/wpa_supplicant.conf
#wpa_driver: nl80211

# Wireless firmware
rtl8192cu_firmware_file: "rtl8192cufw_TMSC.bin"
rtl8192cu_firmware_path: "rtlwifi/{{ rtl8192cu_firmware_file }}"
rtl8192cu_firmware_url: "https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/plain/{{ rtl8192cu_firmware_path }}"

# Gateway collaborator rights
gateway_collaborator_rights:
  - gateway:settings
  - gateway:collaborators
  - gateway:delete
  - gateway:location
  - gateway:status
  - gateway:owner
  - gateway:messages

# Use GPS if present
use_gps: false
gps_device: ttyXRUSB2

# The following were taken from multitech_overrides.json in the
#   mp-packet-forwarder package and are used if no multitech
#   region-specific configuration is provided
multitech_global_overrides: '--json {
    "SX1301_conf": {
        "clksrc_desc": "radio_0 provides clock to concentrator by default"
        "clksrc": 0,
    }
}'

# Source of the config files referenced below
meta_mlinux_git: git://git.multitech.net/meta-mlinux
meta_mlinux_version: 3.3.24
meta_mlinux_root: "{{ role_path }}/files/meta-mlinux"
meta_mlinux_confdir: "{{ meta_mlinux_root }}/recipes-connectivity/lora/lora-packet-forwarder"
ttn_global_conf_root: "https://raw.githubusercontent.com/TheThingsNetwork/gateway-conf/master/"

# See https://www.thethingsnetwork.org/docs/lorawan/frequencies-by-country.html
regions:
  AU:
    desc: "Australia"
    frequency_plan: AU_915_928
    router: meshed_router
  BN:
    desc: "Brunei Darussalam"
    frequency_plan: AS_923_925
    router: ttn-router-asia-se
  EU:
    desc: "Europe, Middle East, Russia and Africa"
    frequency_plan: EU_863_870
    router: ttn-router-eu
  HK:
    desc: "Hong Kong"
    frequency_plan: AS_923_925
    router: ttn-router-asia-se
  ID:
    desc: "Indonesia"
    frequency_plan: AS_923_925
    router: ttn-router-asia-se
  IN:
    desc: "India"
    frequency_plan: IN_865_867
    router: ttn-router-asia-se
  JP:
    desc: "Japan"
    frequency_plan: AS_920_923
    router: ttn-router-jp
  KH:
    desc: "Cambodia"
    frequency_plan: AS_923_925
    router: ttn-router-asia-se
  LA:
    desc: "Lao People's Democratic Republic"
    frequency_plan: AS_923_925
    router: ttn-router-asia-se
  MY:
    desc: "Malaysia"
    frequency_plan: AS_920_923
    router: ttn-router-asia-se
  SG:
    desc: "Signapore"
    frequency_plan: AS_920_923
    router: ttn-router-asia-se
  TH:
    desc: "Thailand"
    frequency_plan: AS_923_925
    router: ttn-router-asia-se
  TW:
    desc: "Taiwan, Province of China"
    frequency_plan: AS_923_925
    router: ttn-router-asia-se
  UK:
    desc: "United Kingdom"
    frequency_plan: EU_863_870
    router: digitalcatapult-uk-router
  US:
    desc: "North and South America"
    frequency_plan: US_902_928
    router: ttn-router-us-west
  VN:
    desc: "Vietnam"
    frequency_plan: AS_923_925
    router: ttn-router-asia-se

frequency_plans:
  AS_920_923:
    product_ids:
      - MTAC-LORA-915
      - MTCAP-LORA-915
      - MTAC-LORA-H-915
    global_conf: AS1-global_conf.json
    "MTAC-LORA-1.5": global_conf.json.3.0.0.MTAC_LORA_1_5.AS923-LBT.basic.clksrc0
    "MTCAP-LORA-1.5": global_conf.json.3.1.0.MTCAP-LORA-1-5.AS923-LBT.basic
  AS_923_925:
    product_ids:
      - MTAC-LORA-915
      - MTCAP-LORA-915
      - MTAC-LORA-H-915
    router: ttn-router-asia-se
    global_conf: AS2-global_conf.json
    "MTAC-LORA-1.5": global_conf.json.3.0.0.MTAC_LORA_1_5.AS923.basic.clksrc0
    "MTCAP-LORA-1.5": global_conf.json.3.1.0.MTCAP-LORA-1-5.AS923.basic
  AU_915_928:
    product_ids:
      - MTAC-LORA-915
      - MTCAP-LORA-915
      - MTAC-LORA-H-915
    router: ttn-router-asia-se
    global_conf: AU-global_conf.json
    "MTAC-LORA-1.5": global_conf.json.3.0.0.MTAC_LORA_1_5.AU915.basic.clksrc0
    "MTCAP-LORA-1.5": global_conf.json.3.1.0.MTCAP-LORA-1-5.AU915.basic
  EU_863_870:
    product_ids:
      - MTAC-LORA-868
      - MTCAP-LORA-868
      - MTAC-LORA-H-868
    router: ttn-router-eu
    global_conf: EU-global_conf.json
    "MTAC-LORA-1.0": global_conf.json.3.0.0.MTAC_LORA_1_0.EU868.basic.clksrc0
    "MTAC-LORA-1.5": global_conf.json.3.0.0.MTAC_LORA_1_5.EU868.basic.clksrc0
    "MTCAP-LORA-1.5": global_conf.json.3.1.0.MTCAP-LORA-1-5.EU868.basic
  IN_865_867:
    product_ids:
      - MTAC-LORA-868
      - MTCAP-LORA-868
      - MTAC-LORA-H-868
    router: ttn-router-asia-se
    global_conf: IN-global_conf.json
    "MTAC-LORA-1.5": global_conf.json.3.0.0.MTAC_LORA_1_5.IN865.basic.clksrc0
    "MTCAP-LORA-1.5": global_conf.json.3.1.0.MTCAP-LORA-1-5.IN865.basic
  KR_920_923:
    product_ids:
      - MTAC-LORA-915
      - MTCAP-LORA-915
      - MTAC-LORA-H-915
    router: ttn-router-asia-se
    global_conf: KR-global_conf.json
    "MTAC-LORA-1.5": global_conf.json.3.0.0.MTAC_LORA_1_5.KR920-LBT.basic.clksrc0
    "MTCAP-LORA-1.5": global_conf.json.3.1.0.MTCAP-LORA-1-5.KR920-LBT.basic
  US_902_928:
    product_ids:
      - MTAC-LORA-915
      - MTCAP-LORA-915
      - MTAC-LORA-H-915
    router: ttn-router-us-west
    global_conf: US-global_conf.json
    "MTAC-LORA-1.0": global_conf.json.3.0.0.MTAC_LORA_1_0.US915.basic.clksrc0
    "MTAC-LORA-1.5": global_conf.json.3.0.0.MTAC_LORA_1_5.US915.basic.clksrc0
    "MTCAP-LORA-1.5": global_conf.json.3.1.0.MTCAP-LORA-1-5.US915.basic

